<script>
  const themeToggle = document.getElementById(
    'theme-toggle',
  ) as HTMLButtonElement | null;
  const themeSlider = document.getElementById(
    'theme-slider',
  ) as HTMLElement | null;
  const sunIcon = document.getElementById('sun-icon') as HTMLElement | null;
  const moonIcon = document.getElementById('moon-icon') as HTMLElement | null;

  const initTheme = (): void => {
    const isDarkMode = window.matchMedia(
      '(prefers-color-scheme: dark)',
    ).matches;
    if (isDarkMode) document.documentElement.classList.add('dark');
    updateThemeUI(isDarkMode);
  };

  const updateThemeUI = (isDark: boolean): void => {
    if (isDark) {
      if (themeSlider) themeSlider.style.transform = 'translateX(32px)';
      if (sunIcon) sunIcon.style.color = 'var(--muted-foreground)';
      if (moonIcon) moonIcon.style.color = 'var(--primary-foreground)';
    } else {
      if (themeSlider) themeSlider.style.transform = 'translateX(0)';
      if (sunIcon) sunIcon.style.color = 'var(--primary-foreground)';
      if (moonIcon) moonIcon.style.color = 'var(--muted-foreground)';
    }
  };

  if (themeToggle) {
    themeToggle.addEventListener('click', () => {
      const html = document.documentElement;
      const isDark = html.classList.contains('dark');

      if (isDark) {
        html.classList.remove('dark');
        localStorage.setItem('theme', 'light');
        updateThemeUI(false);
      } else {
        html.classList.add('dark');
        localStorage.setItem('theme', 'dark');
        updateThemeUI(true);
      }
    });
  }

  window.addEventListener('DOMContentLoaded', initTheme);
  initTheme();
</script>

<button
  id="theme-toggle"
  class="relative inline-flex items-center justify-between w-16 h-8 bg-[color:var(--muted)] rounded-full p-1 transition-colors duration-200 transition-colors hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-[color:var(--ring)] focus:ring-offset-2 dark:focus:ring-offset-[color:var(--background)] cursor-pointer"
  aria-label="Toggle theme"
>
  <div
    id="theme-slider"
    class="absolute left-0 w-8 h-8 bg-[color:var(--primary)] rounded-full transition-transform duration-300"
    aria-hidden="true"
  >
  </div>

  <div class="relative z-10 flex items-center justify-center w-6 h-6">
    <span
      id="sun-icon"
      class="material-symbols-outlined transition-colors duration-300 text-[color:var(--primary-foreground)]"
      >light_mode</span
    >
  </div>

  <div class="relative z-10 flex items-center justify-center w-6 h-6">
    <span
      id="moon-icon"
      class="material-symbols-outlined transition-colors duration-300 text-[color:var(--muted-foreground)]"
      >dark_mode</span
    >
  </div>
</button>

<style>
  :root {
    --background: oklch(1 0 0);
    --foreground: oklch(0.145 0 0);
    --card: oklch(1 0 0);
    --card-foreground: oklch(0.145 0 0);
    --primary: oklch(0.205 0 0);
    --primary-foreground: oklch(0.827 0.057 264);
    --muted: transparent;
    --muted-foreground: oklch(0.556 0 0);
    --border: oklch(0.922 0 0);
    --ring: oklch(0.708 0 0);
  }

  .dark {
    --background: oklch(0.145 0 0);
    --foreground: oklch(0.985 0 0);
    --card: oklch(0.145 0 0);
    --card-foreground: oklch(0.985 0 0);
    --primary: oklch(0.985 0 0);
    --primary-foreground: oklch(0.205 0 0);
    --muted: oklch(0.269 0 0);
    --muted-foreground: oklch(0.708 0 0);
    --border: oklch(0.269 0 0);
    --ring: oklch(0.439 0 0);
  }

  :root {
    color-scheme: light;
  }

  .dark {
    color-scheme: dark;
  }
</style>
